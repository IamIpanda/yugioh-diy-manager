# 卡包编辑器
----
此页面意在随时随地编辑适用于`ygopro`的数据库和卡包。

在一切开始之前，请记住：此页面是一个**纯前端服务**。你的所有数据都以`IndexedDB`形式保存在本地浏览器，没有任何数据实际上传至服务器，页面上的「上传」与「下载」仅为方便理解。

你可以使用`WebDav`以持久化你的文件。

### 更新日志
----
+ 2025-10-15：加入Webdav支持，加入更新字段列表功能，加入卡片过滤功能，允许卡片无id。下方说明文字有少许修改。
+ 2025-03-30: 更新默认字段列表。修正了特定情况下无法下载卡包的问题。
+ 2024-12-07: 上传中心图前，可以对图像进行简单的编辑。

### 常见操作指南
----
##### 通用
绝大多数操作在完成后会立即保存，下次打开页面依然存在。    
页面右侧（手机上页面下侧）的卡片编辑器上的效果文本编辑框在焦点离开此文本框后保存。
页面右上角的设置内容在设置窗口关闭后保存。

点击右上角的前两个图标进行`ypk`文件/`cdb`文件的上传和下载。    
使用右上角的第三个图标切换过去编辑过的`ypk`文件/`cdb`文件。

##### 关于卡图    
本编辑器内的卡图有两种模式。点击`中心图`按钮使用用中心图生成的卡图，点击`卡图`使用预置的整图。    
中心图模式读取卡包下的 `pico/{code}.jpg`    
卡图模式读取卡包下的 `pics/{code}.jpg`    
点击`中心图`的下拉菜单中的`生成全图`，使用中心图生成全卡卡图，之后可以从`卡图`中的下载按钮下载生成的卡图。    
`pico`文件夹下的文件在生成卡包时会不会被包括在内。
如果你有更好的界面逻辑设计，欢迎与我联系。

##### 如何新建卡片
在左侧（手机上页面上侧）文本框内加入一行卡片起始行。你可以简单生成一张白板卡后使用卡片编辑器编辑：
```
卡片占位符 0
```
文本具体具体请看下一章节。

### 卡片文本格式
----
所有卡片均以文本形式记录，格式参考自知名翻译作者**XYZ龙加农**的卡片格式。    
`#`开头的行是注释行。

卡片应当以以下格式起始：
```
卡名(卡片密码) 其他信息
```
其中卡片密码是必要的，否则程序无法分辨此行是否卡片的起始行。

连接以外的怪兽的起始行的具体格式如下：
```
卡名(卡片密码) 属性 等级[星|阶] 种族/副类别1/副类别2... 攻击力 防御力
```
由于游戏王中效果怪兽占绝大多数，怪兽的副类别中「效果」类别无需加注，「通常」类别需要单独加注。    
灵摆怪兽需在效果文中任意处出现一行：
```
←左刻度 【灵摆】 右刻度→
```
连接怪兽的起始行具体格式如下：
```
卡名(卡片密码) 属性 LINK-连接值 种族/连接/副类别... 攻击力 [连接箭头1][连接箭头2]...
```

魔法·陷阱卡的起始行具体格式如下：
```
卡名(卡片密码) 卡片类别
```   
若需要设置`alias`字段，将卡片密码写成 `卡片密码=>原卡片密码`。    
若需要设置`ot`字段，在起始行最后加上`(TCG)`。默认卡片设置是`OCG&TCG`

正确的起始行范例：
```
青眼白龙(89631141=>89631139) 光 8星 龙/通常 3000 2500
暗钢龙 暗钢(79266769) 暗 LINK-4 龙/连接 2800 [↙][↓][↘][↑]
愚蠢的埋葬(81439173) 通常魔法
```
一些可以兼容的起始行范例：
```
# 缺少卡片密码，会作为id=0的卡被解析
愚蠢的副葬 通常魔法
# 缺少怪兽剩余属性，会作为白板卡被解析
真红眼黑龙(74677422) 暗
# 注释符号#必须出现在一行的开头，因格式不正确会作为白板卡被解析
光与暗之龙王(19652159) 光 10星 龙/融合 3400 3000 #熊猫龙王
```

起始行之后，直到下一个起始行为止，所有内容都是卡片效果文字，以下内容开头的例外：

起始文字|设置字段
-------|--------
效果分类：|category
系列：|setcode
提示文本：|texts
★|flavor_text

系列的字段名需在设置内设置。若找不到字段名，会解析为十六进制数字。

所有满足设置中的`效果排除行`的正则表达式的文本，会存入数据库的卡片效果，但是不会出现在右侧的卡片编辑器中（即不会出现在生成的卡图中）。这些行通常是DIY卡的注释和签名。默认设置排除的行如下：
+ 以`-`或`—`开头的行。
+ 以2-4个文字接一个`：`开头的行。
+ 以中/英文的括号完全包裹的行。
+ 任何包含`DoItYourSelf`的行。

你可以修改设置更改这些行的判定规则。

★卡头的行都会被视为风味文字而单独处理。

### 关于
----
版本：{{PACKAGE_VERSION}}。    

感谢你看到这里。

如果你有任何意见和建议，欢迎来 [Github](https://github.com/IamIpanda/yugioh-diy-manager/issues) 交流。
